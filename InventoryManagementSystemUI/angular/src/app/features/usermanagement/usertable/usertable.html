<app-card cardTitle="User Management" [customHeader]="true">
  <!-- Header with Add Button and Connection Status -->
  <div class="app-card-header d-flex justify-content-between align-items-center">
    <div class="d-flex align-items-center">
      <h5 class="mb-0 me-3">Users</h5>
      <!-- SignalR Connection Status Indicator -->
      <span class="badge" [ngClass]="isConnected ? 'bg-success' : 'bg-secondary'" 
            [title]="isConnected ? 'Real-time notifications connected' : 'Real-time notifications disconnected'">
        <i class="feather" [ngClass]="isConnected ? 'icon-wifi' : 'icon-wifi-off'"></i>
        {{ isConnected ? 'Connected' : 'Disconnected' }}
      </span>
    </div>
    <button class="btn btn-primary" (click)="onAddUser()">
      <i class="feather icon-plus me-2"></i>Add User
    </button>
  </div>

  <!-- Loading Spinner -->
  @if (isLoading) {
    <div class="text-center py-5">
      <div class="spinner-border text-primary" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
      <p class="mt-2 text-muted">Loading users...</p>
    </div>
  }

  <!-- Users Table -->
  @if (!isLoading) {
    <div class="table-responsive">
      <table class="table table-hover">
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Contact</th>
            <th>Role</th>
            <th>Gender</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          @if (users.length === 0) {
            <tr>
              <td colspan="8" class="text-center py-4">
                <div class="text-muted">
                  <i class="feather icon-inbox d-block mb-2" style="font-size: 2rem;"></i>
                  No users found. Click "Add User" to create one.
                </div>
              </td>
            </tr>
          }
          @for (user of users; track user.id) {
            <tr>
          
              <td>
                <div class="d-flex align-items-center">
                  @if (user.profileImage) {
                    <img [src]="user.profileImage" alt="{{ user.name }}" class="rounded-circle me-2" width="32" height="32">
                  } @else {
                    <div class="avatar-circle me-2">
                      <span class="avatar-initial">{{ user.name.charAt(0).toUpperCase() }}</span>
                    </div>
                  }
                  <span class="fw-medium">{{ user.name }}</span>
                </div>
              </td>
              <td>
                <a href="mailto:{{ user.email }}" class="text-decoration-none">
                  <i class="feather icon-mail me-1"></i>{{ user.email }}
                </a>
              </td>
              <td>
                <span>
                  <i class="feather icon-phone me-1"></i>{{ user.contactNumber }}
                </span>
              </td>
              <td>
                <span [ngClass]="getRoleClass(user.roleId)">
                  {{ getRoleLabel(user.roleId) }}
                </span>
              </td>
              <td>
                <span>{{ getGenderLabel(user.gender) }}</span>
              </td>
              <td>
                <span [ngClass]="getStatusClass(user.statusId)">
                  {{ getStatusLabel(user.statusId) }}
                </span>
              </td>
              <td>
                <div class="btn-group" role="group">
                  <!-- View Button -->
                  <button type="button" class="btn btn-sm btn-outline-info" 
                          (click)="onViewUser(user.id)" title="View Details">
                    <i class="feather icon-eye"></i>
                  </button>
                  
                  <!-- Edit Button -->
                  <button type="button" class="btn btn-sm btn-outline-primary" 
                          (click)="onEditUser(user.id)" title="Edit">
                    <i class="feather icon-edit"></i>
                  </button>
                  
                  <!-- Delete Button -->
                  <button type="button" class="btn btn-sm btn-outline-danger" 
                          (click)="onDeleteUser(user.id)" title="Delete">
                    <i class="feather icon-trash-2"></i>
                  </button>
                </div>
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  }
</app-card>